<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../css/style.css">
  <title>Пример 18 - Календарь</title>
</head>

<body>
  <div class="container"></div>

  <script>
    function createCalendar(elem,year,month) {
      elem = document.querySelector(elem)
      //  Нам удобнее передавать в функцию нормальный человеческий месяц 4, а функция должна его преобразовать в месяц 3 для рассчетов JS в котором месяцы от 0 до 11, а наш апрель соответствует числу 3
      let mon = month - 1 
      let d = new Date(year, mon) // С помощью "констуктора дат" сгенерировали полную дату JS. Здесь у нас будет храниться дата, основанная на годе и месяце, которые будем передавать сами. Эту дату надо формировать потому что она создается самим JS согласно вшитому календарю, в котором уже прописаном что нужнное число такогото года такого месяца это например пятница, и не нужно самому это искать по какому-то внешнему календарю. К тому же это будет объект содержащий дату и с ним можно будет работать используя вшитые в него методы для работы с временем
      console.log(d) // Sat Jun 01 2024 00:00:00 GMT+0700 (GMT+07:00) Получили 1 июня суббота (Saturday)
      
      // Если сформировать дату на месяце с номером 4 без вычитания, то получим:
      let d2 = new Date(year, month)
      console.log(d2); // Mon Jul 01 2024 00:00:00 GMT+0700 (GMT+07:00). Результат неправильный, должен быть 01 Июнь Сб, а не 01 Июль Пн. Это потому что мы в качестве значения подставили 6(июнь), но в JS 6 это июль так как отсчет начинается с нуля (как будто 7-ый по счету).

      // далее создадим переменную содержащую шаблонные литералы в которых в виде текста будет находиться код для создания таблицы
      let table = `
      <table>
        <caption>${month}.${year}</caption>
        <tr>
          <th>пн</th>
          <th>вт</th>
          <th>ср</th>
          <th>чт</th>
          <th>пт</th>
          <th>сб</th>
          <th>вс</th>
        </tr>
        <tr>
      ` 
      // <tr> в конце это мы создали новый ряд, но специально не закрыли его для того чтобы дописать туда новые сгенерированные значения
      // элемент caption должен идти сразу же после открывающегося тега <table>

      // Далее цикл, который заполняет в таблице первые дни недели до нашего дня пустыми ячейками. Апрель 2021 года начинается с 1 апреля и это четверг, поэтому нам нужно всё до этого числа заполнить пустыми ячейками
      console.log(getDay(d)); // Получили: 5
      for(let i = 0; i<getDay(d); i++) { // getDay здесь это нами созданная функция. Знак меньше(<) чтобы заполнять пустыми ячейками До первого числа (до 1 июня) 
        table += '<td></td>' // Получили 5 пустые ячейки под Пн, Вт, Ср, Чт, Пт
      }

        // getDay(d) это мы берем переменную d в которой содержится дата в виде объекта JS с уже измененным месяцем-1 и правильным с точки зрения JS календаря, и с помощью функции getDay получаем ЧИСЛО, соответсвующее Пн(1) до Вс(7)

      table += '</tr></table>'
      elem.innerHTML = table

    }
    
    
    // Функция, которая в качестве параметра получает на вход объект-дату в формате JS и на выход выдаёт нам дни недели с Пн(1) до Вс(7) вместо JavaScript_овских дней с Вс(0) по Сб(6):
    function getDay(date) { // здесь getDay это нами самими придуманное название функции, несмотря на то, что оно совпадает с встроенным существующим методом объекта Date
      let day = date.getDay() // getDay это стандартный метод у объекта. Метод getDay() - получить день недели в понимании JS - от 0 (Воскресенье) до 6 (суббота)
      if(day == 0) day = 7 // если по внутреннему календарю это воскресенье, то по умолчанию JS нам выдаст результат число 0(Вс). Делаем чтобы как только попали на день 0 (Вс), то он стал днём 7. Все остальные дни согласно внутреннему календарю JS совпадают с человеческими Пн(1)-Сб(6)
      return day-1 // пишем вернуть "-1" потому что нам нужно подать на вход понедельник(1) и получить 0, подать пятницу(5) и получить 4, подать воскресенье(7) и получить 6
      // а можно было -1 не писать и не мудрить, а просто цикл for начать не с 0, а с человеческой 1  
    }

    createCalendar('body', 2024, 6) // 6 это июнь по человеческому
  </script>
</body>

</html>