// –ü—Ä–∏–º–µ—Ä 39 - –í—ã–¥–µ–ª–µ–Ω–∏–µ Selection

// –í—ã–¥–µ–ª–µ–Ω–∏–µ Selection —ç—Ç–æ –Ω–µ —Å–æ–≤—Å–µ–º —Ç–æ–∂–µ —Å–∞–º–æ–µ —á—Ç–æ –î–∏–∞–ø–∞–∑–æ–Ω Range. –î–∏–∞–ø–∞–∑–æ–Ω Range –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º —á—Ç–æ-—Ç–æ –≤—ã–±—Ä–∞—Ç—å, –Ω–æ –º—ã –Ω–∏–∫–∞–∫ —Å –ø–æ–º–æ—â—å—é –Ω–µ–≥–æ –Ω–µ –≤–ª–∏—è–µ–º –Ω–∞ –≤—ã–¥–µ–ª–µ–Ω–∏–µ, –Ω–æ –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ —ç—Ç–∏ —É–∑–ª—ã, —Ç–µ–∫—Å—Ç,  –∑–∞–ø–∏—Å–∞—Ç—å –∏—Ö –≤ –∫–∞–∫—É—é-—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é,  —Å–æ–∑–¥–∞—Ç—å –Ω–∞ –∏—Ö –æ—Å–Ω–æ–≤–µ –∫–∞–∫–æ–π —Ç–æ –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–ª–µ–µ –≤ –∫–æ–¥–µ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É.–∞—Å –ø–æ–º–æ—â—å—é –≤—ã–¥–µ–ª–µ–Ω–∏—è –º—ã –º–æ–∂–µ–º –∏–º–µ–Ω–Ω–æ –≤—ã–¥–µ–ª—è—Ç—å —Ç–µ–∫—Å—Ç –∏–ª–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –º–æ–º–µ–Ω—Ç –∫–æ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –∏ —á—Ç–æ-—Ç–æ –¥–µ–ª–∞—Ç—å –≤ —ç—Ç–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö.

// –¢–∞–∫ –∂–µ –∫–∞–∫ –∏ —É –¥–∏–∞–ø–∞–∑–æ–Ω–∞, –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∏–º–µ–µ—Ç –Ω–∞—á–∞–ª—å–Ω—É—é –≥—Ä–∞–Ω–∏—Ü—É, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —è–∫–æ—Ä—å,–∏ –∫–æ–Ω–µ—á–Ω—É—é, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ñ–æ–∫—É—Å.

// —Å–æ–±—ã—Ç–∏–µ onselectionchange –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–æ–≥–¥–∞ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –≤—ã–¥–µ–ª–µ–Ω–∏–µ
document.onselectionchange = function ()  {

    // <p id="p">–¢–µ–∫—Å—Ç: <i>–∫—É—Ä—Å–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç</i> –∏ <b>–∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç</b></p>
    // –í—ã–¥–µ–ª–∏–º –º—ã—à–∫–æ–π: –∫—É—Ä—Å–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç –∏ –∂–∏—Ä

    // –≤—ã–≤–µ–¥–µ–º –≤ –∫–æ–Ω—Å–æ–ª—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ –≤ –≤–∏–¥–µ —Ç–µ–∫—Å—Ç–∞:
    console.log("üöÄdocument.getSelection().toString(): ", document.getSelection().toString());
    // –∫—É—Ä—Å–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç –∏ –∂–∏—Ä

    // —è–∫–æ—Ä—å–£–∑–µ–ª, –Ø–∫–æ—Ä—å–°–º–µ—â–µ–Ω–∏–µ, —Ñ–æ–∫—É—Å–£–∑–µ–ª, —Ñ–æ–∫—É—Å–°–º–µ—â–µ–Ω–∏–µ
    let {anchorNode, anchorOffset, focusNode, focusOffset} = document.getSelection()
    // —Ç–∞–∫–∞—è –∑–∞–ø–∏—Å—å –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–∞–∫ —Ç–æ–ª—å–∫–æ –º—ã –±—É–¥–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ, –º—ã –ø–æ–º–µ—Å—Ç–∏–º –≤—Å–µ –µ–≥–æ 4 –∑–Ω–∞—á–µ–Ω–∏—è –≤ 4 –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–∞

    // —É –Ω–∞—Å –µ—Å—Ç—å 2 input, id="from" –∏ id="to"
    // –ø–æ–º–µ—Å—Ç–∏–º –≤ –ø–µ—Ä–≤—ã–π input –∑–Ω–∞—á–µ–Ω–∏–µ:
    from.value = `${anchorNode && anchorNode.data}:${anchorOffset}`;
    // —ç—Ç–æ –∫–æ–¥ –∞–≤—Ç–æ—Ä–æ–º —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –∏–∑ https://learn.javascript.ru/selection-range, –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ –∫–∞–∫ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç

    // && –æ–∑–Ω–∞—á–∞–µ—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –ò
    console.log("—É–∑–µ–ª —è–∫–æ—Ä—è ~ anchorNode:", anchorNode); // "–∫—É—Ä—Å–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç"
    console.log("anchorNode.data:", anchorNode.data);    // –∫—É—Ä—Å–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç
    console.log("—Å–º–µ—â–µ–Ω–∏–µ —è–∫–æ—Ä—è ~ anchorOffset:", anchorOffset); // 0

    // –ù–∞ html-—Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤ input ‚Ññ1 –ø–æ–ª—É—á–∏–ª–∏: "–∫—É—Ä—Å–∏–≤–Ω—ã–π —Ç–µ–∫—Å—Ç: 0"

    to.value = `${focusNode && focusNode.data}:${focusOffset}`;
    // –ù–∞ html-—Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤ input ‚Ññ2 –ø–æ–ª—É—á–∏–ª–∏: "–∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç: 3"

    console.log("—É–∑–µ–ª —Ñ–æ–∫—É—Å–∞ ~ focusNode:", focusNode); // "–∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç"
    console.log("focusNode.data:", focusNode.data);     // –∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç
    console.log("—Å–º–µ—â–µ–Ω–∏–µ —Ñ–æ–∫—É—Å–∞ ~ focusOffset:", focusOffset); // 3

}

function proverka ()
{
let D
let A=1
let B=2
let C=3
D = `${A && B}:${C}`;
console.log('D= ' + D);
// D= 2:3

let D2
let A2
let B2=2
let C2=3
D2 = `${A2 && B2}:${C2}`;
console.log('D= ' + D2);
// D= undefined:3

let D3
let A3
let B3=2
let C3=3
D3 = `${A3 && B3}:${C3}`;
console.log('D= ' + D3);
// D= undefined:3

}

// proverka()

// –°—Ç–∞—Ç—å—è: https://learn.javascript.ru/selection-range

// —É—Å—Ç–∞–Ω–æ–≤–∏–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ html-—Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –ø–æ–º–æ—â—å—é –∫–æ–¥–∞ –∏–∑ JS:
document.getSelection().setBaseAndExtent(p, 0, p, p.childNodes.length);
// p, 0 - —ç—Ç–æ –Ω–∞—á–∞–ª—å–Ω—ã–π —É–∑–µ–ª –∏ —Å–º–µ—â–µ–Ω–∏–µ
// p, p.childNodes.length - —ç—Ç–æ –Ω–∞—á–∞–ª—å–Ω—ã–π —É–∑–µ–ª –∏ —Å–º–µ—â–µ–Ω–∏–µ.
console.log("p.childNodes.length:" + p.childNodes.length);
// p.childNodes.length:4
// p.childNodes.length –≤—ã—á–∏—Å–ª—è–µ—Ç —Ü–µ–ª–æ–µ –∫–æ–Ω–µ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —É–∑–ª–æ–≤ –≤ —Ç–µ–≥–µ p, –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —ç—Ç–æ 4. –ï—Å–ª–∏ –ø–æ–º–µ–Ω—è—Ç—å p.childNodes.length –Ω–∞ 3, —Ç–æ –ø–æ–ª—É—á–∏–º –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–µ —Å–Ω–∞—á–∞–ª–∞ –∏ –±–µ–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —É–∑–ª–∞ <b>–∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç</b>

// –µ—Å–ª–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–µ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Ç–æ –µ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–Ω—è—Ç—å –ø–æ–º–æ—â—å—é removeAllRanges() –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—ã–¥–µ–ª–µ–Ω–∏–π –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, –≤—ã–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –û–î–ù–û.

// —Ç–µ–ø–µ—Ä—å —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤—ã–¥–µ–ª–µ–Ω–∏—è –≤ —ç–ª–µ–º–µ–Ω—Ç–∞—Ö —Ñ–æ—Ä–º

area.onselect = function () {
    console.log(`–ù–∞—á–∞–ª–æ: ${area.selectionStart} –ö–æ–Ω–µ—Ü: ${area.selectionEnd}`);
    // –í—ã–¥–µ–ª–∏–≤ —á–∞—Å—Ç—å —Ç–µ–∫—Å—Ç–∞ –≤–Ω—É—Ç—Ä–∏ textarea –ø–æ–ª—É—á–∏–ª–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏:
    // –ù–∞—á–∞–ª–æ: 0 –ö–æ–Ω–µ—Ü: 58
}

// –º—ã –º–æ–∂–µ–º –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é –∫—É—Ä—Å–æ—Ä–∞ –≤–Ω—É—Ç—Ä–∏ textarea:
area.onfocus = () => {
    setTimeout(()=>{
        area.selectionStart = area.selectionEnd = 10;
        // –∫–æ–≥–¥–∞ –º—ã –Ω–∞—á–∞–ª—å–Ω—É—é –∏ –∫–æ–Ω–µ—á–Ω—É—é —Ç–æ—á–∫—É –≤—ã–¥–µ–ª–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∏–º –≤ –æ–¥–Ω–æ –∏ —Ç–æ–∂–µ –º–µ—Å—Ç–æ, —Ç–æ —É –Ω–∞—Å –∫—É—Ä—Å–æ—Ä —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤ –æ–¥–Ω—É —Ç–æ—á–∫—É
        // —Ç–µ–ø–µ—Ä—å –∫–æ–≥–¥–∞ –º—ã –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫—É—Ä—Å–æ—Ä –º—ã—à–∏ (—Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–ª–∏—Å—å –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç–µ) –≤ –ø–æ–ª–µ textarea, –Ω–∞—à –∫—É—Ä—Å–æ—Ä –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–µ –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ, –∞ –Ω–∞ 10 —Å–∏–º–≤–æ–ª–µ
        // setTimeout –º—ã —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏ —á—Ç–æ–±—ã –Ω–∞—à –∫–æ–¥ —Å—Ä–∞–±–æ—Ç–∞–ª —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∫–∏. –µ—Å–ª–∏ setTimeout —É–±—Ä–∞—Ç—å, —Ç–æ –∫–æ–¥ –ø–µ—Ä–µ—Å—Ç–∞—ë—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –ø–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–¥ –¥–æ–ª–∂–µ–Ω —Å—Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –º—ã —â–µ–ª–∫–Ω–µ–º –º—ã—à–∫–æ–π –∏ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫—É—Ä—Å–æ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –∞ –¥–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–∞ —Ö–æ—Ç—å –∫–∞–∫–∞—è-—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞, –¥–∞–∂–µ –µ—Å–ª–∏ –º—ã –Ω–µ —É–∫–∞–∑–∞–ª–∏ –∑–∞–¥–µ—Ä–∂–∫—É —á–∏—Å–ª–µ–Ω–Ω–æ, —Ç–µ–ø–µ—Ä—å –æ–Ω–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –∏ –∫–æ–¥ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞ –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥—É –ø–æ–∑–∂–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º–æ–≥–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    })
}

// * 3 —Å–ø–æ—Å–æ–±–∞ –∑–∞–ø—Ä–µ—Ç–∞ –≤—ã–¥–µ–ª–µ–Ω–∏—è –Ω–∞ —Å–∞–π—Ç–µ:

// –°–ø–æ—Å–æ–± ‚Ññ1:
// –≤ —Å—Ç–∏–ª—è—Ö CSS  –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π—Å—Ç–≤–æ user-select: none

/*
CSS style.css:
#p {
    user-select: none;
  }
*/

// —á—Ç–æ–±—ã –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é JS:

function forbidSelect1 () { // –∏–∑–æ–ª—è—Ü–∏—è
p.onselectstart = () => false;
// —Ç–µ–ø–µ—Ä—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å —Ç–µ–∫—Å—Ç
}

// forbidSelect1 ()

function forbidSelect2 () { // –∏–∑–æ–ª—è—Ü–∏—è
    document.onselectionchange = function ()  {
        document.getSelection().empty()
    }
// —Ç–µ–ø–µ—Ä—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å —Ç–µ–∫—Å—Ç –≤–æ–æ–±—â–µ –Ω–∞ –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
}
// forbidSelect2 ()